function runPlugin(){figma.ui.onmessage=(e=>{if(shapeCounter=0,!0===e.data.RecValue&&shapeCounter++,!0===e.data.EllValue&&shapeCounter++,!0===e.data.PolyValue&&shapeCounter++,!0===e.data.StarValue&&shapeCounter++,"generate-random"===e.type)if(0===figma.currentPage.selection.length)figma.notify("Please select a frame to add Confetti",{timeout:1200});else if("FRAME"!==figma.currentPage.selection[0].type)figma.notify("Please select a frame to add Confetti",{timeout:1200});else if(0===shapeCounter)figma.notify("Please select shapes to generate confetti",{timeout:1200});else{const t=e.data;for(const e of figma.currentPage.selection)"FRAME"===e.type&&randomConfetti(e,t,randomColors,shapeCounter)}if("generate-selection"===e.type)if(0===figma.currentPage.selection.length)figma.notify("Please select a frame to add Confetti",{timeout:1200});else if("FRAME"!==figma.currentPage.selection[0].type)figma.notify("Please select a frame to add Confetti",{timeout:1200});else if(0===shapeCounter)figma.notify("Please select shapes to generate confetti",{timeout:1200});else{const t=e.data,n=e.data.inputColors;for(const e of figma.currentPage.selection)"FRAME"===e.type&&(0===n.length?figma.notify("Color palette is empty. Please add colors.",{timeout:1200}):selectionColorsConfetti(e,t,n,shapeCounter))}})}function selectionColorsConfetti(e,t,n,o){const a=[];for(let e of n){let t=hexToRgbDivBy255(e);a.push(t)}generateConfetti(e,t,a,o)}function randomConfetti(e,t,n,o){generateConfetti(e,t,n,o)}function generateConfetti(e,t,n,o){const a=t.input,i=e.width,r=e.height;let l=a/o;if(!0===t.RecValue)for(let t=0;t<l;t++){const t=figma.createRectangle(),o=numBetween(.007*i,.04*i),a=numBetween(.01*r,.02*r);t.resize(o,a),t.x=numBetween(0,i),t.y=numBetween(0,r),t.fills=[{type:"SOLID",color:setColor(n),opacity:setOpacity()}],t.rotation=numBetween(-180,180),e.appendChild(t)}if(!0===t.EllValue)for(let t=0;t<l;t++){const t=figma.createEllipse(),o=numBetween(.005*i,.015*i),a=o;t.resize(o,a),t.x=numBetween(0,i),t.y=numBetween(0,r),t.fills=[{type:"SOLID",color:setColor(n),opacity:setOpacity()}],e.appendChild(t)}if(!0===t.PolyValue)for(let t=0;t<l;t++){const t=figma.createPolygon();t.pointCount=numBetween(3,6);const o=numBetween(.01*i,.02*i),a=o;t.resize(o,a),t.x=numBetween(0,i),t.y=numBetween(0,r),t.fills=[{type:"SOLID",color:setColor(n),opacity:setOpacity()}],t.rotation=numBetween(-180,180),e.appendChild(t)}if(!0===t.StarValue)for(let t=0;t<l;t++){const t=figma.createStar();t.pointCount=numBetween(4,6);const o=numBetween(.01*i,.02*i),a=o;t.resize(o,a),t.x=numBetween(0,i),t.y=numBetween(0,r),t.fills=[{type:"SOLID",color:setColor(n),opacity:setOpacity()}],t.rotation=numBetween(-180,180),e.appendChild(t)}}function numBetween(e,t){return Math.floor(Math.random()*(t-e+1))+e}function setColor(e){return e[Math.floor(Math.random()*e.length)]}function setOpacity(){return opacity[Math.floor(Math.random()*opacity.length)]}function hexToRgbDivBy255(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:null}figma.showUI(__html__,{width:250,height:480});var shapeCounter=0;const randomColors=[{r:.01,g:.64,b:.96},{r:.605,g:.96,b:.99},{r:.789,g:.99,b:.746},{r:.863,g:.738,b:.98},{r:.99,g:.621,b:.109},{r:.617,g:.93,b:.102},{r:.46,g:.374,b:.996},{r:1,g:.13,b:.985},{r:.964,g:.144,b:.519},{r:.281,g:.046,b:.656},{r:.296,g:.785,b:.937},{r:.96,g:.277,b:.129},{r:1,g:.93,b:.21},{r:.73,g:.242,b:.011}],opacity=[.35,.45,.6,.65,.75,.85,.9,1];runPlugin();